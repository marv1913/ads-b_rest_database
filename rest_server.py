import json
from datetime import datetime

import psycopg2
from flask import Flask, request

from flight_db import FlightDB
import range

app = Flask(__name__)
flight_database = FlightDB('postgres', 'admin', '192.168.178.54', 5432, 'postgres')

@app.route('/')
def main():
    return 'some text'

# ToDo GET-Request
@app.route('/actual_flight_data', methods=['POST'])
def view_do_something():
    if request.method == 'POST':
        return json.dumps(flight_database.check_flight_dicts(range.get_flight_information_dict()))
        #return json.dumps([{'flight': 'GEC8384', 'lat': 51.912449, 'lon': 13.233503, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:04:55'}, {'flight': 'GEC8384', 'lat': 51.915253, 'lon': 13.242722, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:00'}, {'flight': 'GEC8384', 'lat': 51.919968, 'lon': 13.258362, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:04'}, {'flight': 'GEC8384', 'lat': 51.925344, 'lon': 13.276271, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:09'}, {'flight': 'GEC8384', 'lat': 51.929301, 'lon': 13.289455, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:13'}, {'flight': 'GEC8384', 'lat': 51.933838, 'lon': 13.30452, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:18'}, {'flight': 'GEC8384', 'lat': 51.936584, 'lon': 13.313751, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:22'}, {'flight': 'GEC8384', 'lat': 51.938471, 'lon': 13.319903, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:27'}, {'flight': 'GEC8384', 'lat': 51.949597, 'lon': 13.357178, 'altitude': 31008, 'track': 64, 'speed': 458, 'time_added': '2020-05-31 23:05:36'}, {'flight': 'GEC8384', 'lat': 51.958557, 'lon': 13.386993, 'altitude': 31008, 'track': 64, 'speed': 457, 'time_added': '2020-05-31 23:05:45'}, {'flight': 'GEC8384', 'lat': 51.962213, 'lon': 13.39924, 'altitude': 31008, 'track': 64, 'speed': 457, 'time_added': '2020-05-31 23:05:49'}, {'flight': 'GEC8384', 'lat': 51.964966, 'lon': 13.408508, 'altitude': 31008, 'track': 64, 'speed': 457, 'time_added': '2020-05-31 23:05:54'}, {'flight': 'GEC8384', 'lat': 51.968719, 'lon': 13.421097, 'altitude': 31008, 'track': 64, 'speed': 457, 'time_added': '2020-05-31 23:05:58'}, {'flight': 'GEC8384', 'lat': 51.981718, 'lon': 13.464687, 'altitude': 31008, 'track': 64, 'speed': 455, 'time_added': '2020-05-31 23:06:12'}, {'flight': 'GEC8384', 'lat': 52.0177, 'lon': 13.585739, 'altitude': 31008, 'track': 64, 'speed': 455, 'time_added': '2020-05-31 23:06:51'}, {'flight': 'SVR3814', 'lat': 52.008626, 'lon': 13.292672, 'altitude': 36992, 'track': 65, 'speed': 413, 'time_added': '2020-05-31 23:11:05'}, {'flight': 'SVR3814', 'lat': 52.011233, 'lon': 13.30154, 'altitude': 36992, 'track': 65, 'speed': 413, 'time_added': '2020-05-31 23:11:10'}, {'flight': 'SVR3814', 'lat': 52.015329, 'lon': 13.315587, 'altitude': 36992, 'track': 65, 'speed': 413, 'time_added': '2020-05-31 23:11:14'}, {'flight': 'SVR3814', 'lat': 52.035919, 'lon': 13.385315, 'altitude': 36992, 'track': 64, 'speed': 414, 'time_added': '2020-05-31 23:11:40'}, {'flight': 'GEC8384', 'lat': 52.362488, 'lon': 14.778824, 'altitude': 31008, 'track': 65, 'speed': 456, 'time_added': '2020-05-31 23:13:16'}, {'flight': 'SVR3814', 'lat': 52.195404, 'lon': 13.934708, 'altitude': 36992, 'track': 65, 'speed': 411, 'time_added': '2020-05-31 23:15:14'}, {'flight': 'SVR3814', 'lat': 52.212245, 'lon': 13.993286, 'altitude': 36992, 'track': 65, 'speed': 410, 'time_added': '2020-05-31 23:15:18'}, {'flight': 'SVR3814', 'lat': 52.22081, 'lon': 14.023361, 'altitude': 36992, 'track': 65, 'speed': 410, 'time_added': '2020-05-31 23:15:27'}, {'flight': 'SVR3814', 'lat': 52.227539, 'lon': 14.046936, 'altitude': 36992, 'track': 65, 'speed': 410, 'time_added': '2020-05-31 23:15:36'}, {'flight': 'SVR3814', 'lat': 52.240173, 'lon': 14.091339, 'altitude': 36992, 'track': 65, 'speed': 411, 'time_added': '2020-05-31 23:15:49'}, {'flight': 'SVR3814', 'lat': 52.240968, 'lon': 14.094125, 'altitude': 36992, 'track': 65, 'speed': 411, 'time_added': '2020-05-31 23:15:54'}, {'flight': 'SVR3814', 'lat': 52.382996, 'lon': 14.592514, 'altitude': 36992, 'track': 62, 'speed': 410, 'time_added': '2020-05-31 23:18:47'}, {'flight': 'SVR3814', 'lat': 52.384907, 'lon': 14.598319, 'altitude': 36992, 'track': 61, 'speed': 410, 'time_added': '2020-05-31 23:18:52'}, {'flight': 'SVR3814', 'lat': 52.391657, 'lon': 14.617937, 'altitude': 36992, 'track': 60, 'speed': 408, 'time_added': '2020-05-31 23:18:56'}, {'flight': 'SVR3814', 'lat': 52.395493, 'lon': 14.628525, 'altitude': 36992, 'track': 60, 'speed': 408, 'time_added': '2020-05-31 23:19:01'}, {'flight': 'SVR3814', 'lat': 52.401123, 'lon': 14.644089, 'altitude': 36992, 'track': 59, 'speed': 407, 'time_added': '2020-05-31 23:19:05'}, {'flight': 'SVR3814', 'lat': 52.404692, 'lon': 14.653957, 'altitude': 36992, 'track': 59, 'speed': 407, 'time_added': '2020-05-31 23:19:10'}, {'flight': 'SVR3814', 'lat': 52.408585, 'lon': 14.664764, 'altitude': 36992, 'track': 59, 'speed': 407, 'time_added': '2020-05-31 23:19:15'}, {'flight': 'SVR3814', 'lat': 52.413391, 'lon': 14.678116, 'altitude': 36992, 'track': 60, 'speed': 407, 'time_added': '2020-05-31 23:19:19'}, {'flight': 'SVR3814', 'lat': 52.418099, 'lon': 14.691389, 'altitude': 36992, 'track': 60, 'speed': 407, 'time_added': '2020-05-31 23:19:24'}, {'flight': 'SVR3814', 'lat': 52.421125, 'lon': 14.699786, 'altitude': 36992, 'track': 60, 'speed': 406, 'time_added': '2020-05-31 23:19:28'}, {'flight': 'SVR3814', 'lat': 52.426575, 'lon': 14.715271, 'altitude': 36992, 'track': 60, 'speed': 406, 'time_added': '2020-05-31 23:19:33'}, {'flight': 'SVR3814', 'lat': 52.430389, 'lon': 14.725917, 'altitude': 36992, 'track': 60, 'speed': 406, 'time_added': '2020-05-31 23:19:37'}, {'flight': 'SVR3814', 'lat': 52.432205, 'lon': 14.731064, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:19:42'}, {'flight': 'SVR3814', 'lat': 52.437149, 'lon': 14.745102, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:19:46'}, {'flight': 'SVR3814', 'lat': 52.443005, 'lon': 14.761623, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:19:51'}, {'flight': 'SVR3814', 'lat': 52.447567, 'lon': 14.774336, 'altitude': 36992, 'track': 60, 'speed': 404, 'time_added': '2020-05-31 23:19:56'}, {'flight': 'SVR3814', 'lat': 52.451385, 'lon': 14.785004, 'altitude': 36992, 'track': 60, 'speed': 404, 'time_added': '2020-05-31 23:20:00'}, {'flight': 'SVR3814', 'lat': 52.45697, 'lon': 14.800624, 'altitude': 36992, 'track': 60, 'speed': 404, 'time_added': '2020-05-31 23:20:05'}, {'flight': 'SVR3814', 'lat': 52.460815, 'lon': 14.811401, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:20:09'}, {'flight': 'SVR3814', 'lat': 52.464791, 'lon': 14.822675, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:20:14'}, {'flight': 'SVR3814', 'lat': 52.469586, 'lon': 14.836016, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:20:18'}, {'flight': 'SVR3814', 'lat': 52.473267, 'lon': 14.846344, 'altitude': 36992, 'track': 60, 'speed': 405, 'time_added': '2020-05-31 23:20:23'}, {'flight': 'SVR3814', 'lat': 52.478524, 'lon': 14.861128, 'altitude': 36992, 'track': 60, 'speed': 407, 'time_added': '2020-05-31 23:20:27'}, {'flight': 'SVR3814', 'lat': 52.481689, 'lon': 14.870071, 'altitude': 36992, 'track': 60, 'speed': 408, 'time_added': '2020-05-31 23:20:32'}, {'flight': 'SVR3814', 'lat': 52.486391, 'lon': 14.883336, 'altitude': 36992, 'track': 60, 'speed': 409, 'time_added': '2020-05-31 23:20:37'}, {'flight': 'SVR3814', 'lat': 52.491372, 'lon': 14.897226, 'altitude': 36992, 'track': 60, 'speed': 411, 'time_added': '2020-05-31 23:20:41'}, {'flight': 'SVR3814', 'lat': 52.493454, 'lon': 14.90303, 'altitude': 36992, 'track': 60, 'speed': 412, 'time_added': '2020-05-31 23:20:46'}, {'flight': 'SVR3814', 'lat': 52.498215, 'lon': 14.916452, 'altitude': 36992, 'track': 60, 'speed': 412, 'time_added': '2020-05-31 23:20:50'}, {'flight': 'SVR3814', 'lat': 52.509064, 'lon': 14.946976, 'altitude': 36992, 'track': 60, 'speed': 413, 'time_added': '2020-05-31 23:21:03'}, {'flight': 'SVR3814', 'lat': 52.515701, 'lon': 14.96582, 'altitude': 36992, 'track': 60, 'speed': 415, 'time_added': '2020-05-31 23:21:08'}, {'flight': 'SVR3814', 'lat': 52.521399, 'lon': 14.981899, 'altitude': 36992, 'track': 60, 'speed': 416, 'time_added': '2020-05-31 23:21:17'}, {'flight': 'SVR3814', 'lat': 52.552263, 'lon': 15.069318, 'altitude': 36992, 'track': 60, 'speed': 415, 'time_added': '2020-05-31 23:21:48'}, {'flight': 'CLX7447', 'lat': 51.985396, 'lon': 13.203605, 'altitude': 32992, 'track': 65, 'speed': 462, 'time_added': '2020-05-31 23:26:48'}, {'flight': 'CLX7447', 'lat': 51.987863, 'lon': 13.212001, 'altitude': 32992, 'track': 65, 'speed': 462, 'time_added': '2020-05-31 23:26:52'}, {'flight': 'CLX7447', 'lat': 51.991516, 'lon': 13.224487, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:26:57'}, {'flight': 'CLX7447', 'lat': 51.997593, 'lon': 13.245353, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:01'}, {'flight': 'CLX7447', 'lat': 52.000305, 'lon': 13.254776, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:06'}, {'flight': 'CLX7447', 'lat': 52.006393, 'lon': 13.275681, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:11'}, {'flight': 'CLX7447', 'lat': 52.010056, 'lon': 13.288193, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:15'}, {'flight': 'CLX7447', 'lat': 52.014862, 'lon': 13.304672, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:20'}, {'flight': 'CLX7447', 'lat': 52.018634, 'lon': 13.317784, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:24'}, {'flight': 'CLX7447', 'lat': 52.023196, 'lon': 13.3334, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:29'}, {'flight': 'CLX7447', 'lat': 52.026921, 'lon': 13.34627, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:33'}, {'flight': 'CLX7447', 'lat': 52.027725, 'lon': 13.349075, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:38'}, {'flight': 'CLX7447', 'lat': 52.035049, 'lon': 13.374329, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:42'}, {'flight': 'CLX7447', 'lat': 52.03862, 'lon': 13.386536, 'altitude': 32992, 'track': 65, 'speed': 461, 'time_added': '2020-05-31 23:27:47'}])
    else:
        return "NO OK"


@app.route('/history_of_flight', methods=['POST'])
def view_do():
    if request.method == 'POST':
        flight_number = request.get_data().decode("utf-8")
        all_coordinates = flight_database.get_all_coordinates_of_flight_number(flight_number)
        return json.dumps(all_coordinates)
    else:
        return "NO OK"


if __name__ == '__main__':
    app.run(host='192.168.178.40')


